<?xml version="1.0" encoding="utf-8"?>
<doctrine-mapping xmlns="http://doctrine-project.org/schemas/orm/doctrine-mapping" xsi="http://www.w3.org/2001/XMLSchema-instance" schemaLocation="http://doctrine-project.org/schemas/orm/doctrine-mapping http://doctrine-project.org/schemas/orm/doctrine-mapping.xsd">
    <entity name="Sonata\Bundle\InvoiceBundle\Entity\InvoiceElement" table="sonata_invoice_elements">
        <change-tracking-policy>DEFERRED_IMPLICIT</change-tracking-policy>

        <id name="id" type="integer" column="id">
            <generator strategy="AUTO"/>
        </id>
        
        <field name="invoice_id"        type="integer"  column="invoice_id"/>
        <field name="order_element_id"  type="integer"  column="order_element_id"/>
        <field name="quantity"          type="integer"  column="quantity"/>
        <field name="price"             type="decimal"  column="price"              scale="4"/>
        <field name="vat"               type="decimal"  column="vat"                scale="4"/>
        <field name="total"             type="decimal"  column="total"              scale="4"/>
        <field name="designation"       type="string"   column="designation"        length="255"/>
        <field name="description"       type="text"     column="description"/>

        <one-to-many
            field="invoice"
            target-entity="Sonata\Bundle\InvoiceBundle\Entity\Invoice"
            mapped-by="invoice_elements"
            orphan-removal="">

            <join-columns>
                <join-column
                    name="invoice_id"
                    referenced-column-name="id"
                    on-delete="CASCADE"/>
            </join-columns>
        </one-to-many>

        <one-to-many
            field="order_element"
            target-entity="Sonata\Bundle\InvoiceBundle\Entity\OrderElement" 
            mapped-by="invoice_element"
            orphan-removal="">
            <join-columns>
                <join-column
                    name="order_element_id"
                    referenced-column-name="id"
                    on-delete="CASCADE"/>
            </join-columns>
        </one-to-many>

        <lifecycle-callbacks/>
        
    </entity>
</doctrine-mapping>
